<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cash Drawer Calculator (USD)</title>

    <!-- Prevent caching during dev -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <!-- Stripe.js (Test Mode) -->
    <script src="https://js.stripe.com/v3/"></script>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-functions-compat.js"></script> <!-- ADD THIS -->

    <link rel="stylesheet" href="css/styles.css?v=3">
</head>
<body>
<!-- ==================== MENU (TOP-LEFT) ==================== -->
<div class="menu-container">
    <button id="menuToggle" class="menu-toggle" aria-expanded="false">Menu</button>
    <nav id="menuDropdown" class="menu-dropdown" aria-hidden="true">
        <a href="#" id="menuCalculator">Calculator</a>
        <a href="#" id="menuAbout">About</a>
        <a href="#" id="menuPrivacy">Privacy Policy</a>
        <a href="#" id="menuAccount">Account</a>
        <a href="#" id="authLink">Login/Signup</a>
    </nav>
</div>

<!-- ==================== HEADER ==================== -->
<div class="header">
    <div id="userStatus">Logged in as Guest</div>
</div>

<!-- ==================== INPUT SCREEN ==================== -->
<div id="inputScreen" class="screen">
    <div id="drawerSelector">
        <button id="prevDrawer">Previous</button>
        <h1 id="drawerTitle">Drawer 1</h1>
        <button id="nextDrawer">Next</button>
    </div>
    <div id="error"></div>
    <form id="cashForm">
        <h2>Target State</h2>
        <label>Target Drawer State: <input type="number" min="0" step="0.01" id="targetInput" value="100.00"></label>

        <h2>Banknotes (Count)</h2>
        <label>$100: <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" id="b100" placeholder="0"></label>
        <label>$50: <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" id="b50" placeholder="0"></label>
        <label>$20: <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" id="b20" placeholder="0"></label>
        <label>$10: <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" id="b10" placeholder="0"></label>
        <label>$5: <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" id="b5" placeholder="0"></label>
        <label>$2: <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" id="b2" placeholder="0"></label>
        <label>$1: <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" id="b1" placeholder="0"></label>

        <h2>Coins (Loose Count)</h2>
        <label>Dollars ($1.00): <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" id="c100" placeholder="0"></label>
        <label>Half-Dollars ($0.50): <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" id="c050" placeholder="0"></label>
        <label>Quarters ($0.25): <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" id="c025" placeholder="0"></label>
        <label>Dimes ($0.10): <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" id="c010" placeholder="0"></label>
        <label>Nickels ($0.05): <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" id="c005" placeholder="0"></label>
        <label>Pennies ($0.01): <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" id="c001" placeholder="0"></label>

        <h2>Rolls</h2>
        <label>Quarter Rolls Count: <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" id="rq" placeholder="0"></label>
        <label>Value per Quarter Roll: <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" step="0.01" id="rvq" value="10.00" placeholder="0"></label>
        <label>Dime Rolls Count: <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" id="rd" placeholder="0"></label>
        <label>Value per Dime Roll: <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" step="0.01" id="rvd" value="5.00" placeholder="0"></label>
        <label>Nickel Rolls Count: <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" id="rn" placeholder="0"></label>
        <label>Value per Nickel Roll: <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" step="0.01" id="rvn" value="2.00" placeholder="0"></label>
        <label>Penny Rolls Count: <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" id="rp" placeholder="0"></label>
        <label>Value per Penny Roll: <input type="number" inputmode="decimal" pattern="[0-9]*" min="0" step="0.01" id="rvp" value="0.50" placeholder="0"></label>

        <button type="button" id="clearFormBtn">Clear</button>
        <button type="button" id="goToCheckoutBtn">Drawer Checkout</button>
        <button type="button" id="goToSummaryBtn">Summary Dashboard</button>
    </form>
    <div id="result"></div>
</div>

<!-- ==================== CHECKOUT SCREEN ==================== -->
<div id="checkoutScreen" class="screen" style="display:none;">
    <h1>Drawer Checkout</h1>
    <div>Total Cash: $<span id="totalCash"></span></div>
    <div id="targetStatus"></div>
    <label>Goal Target (Input screen): $<span id="goalTarget">100.00</span></label>
    <label>
        Default Drawer State (Count Down To):
        <input type="number" min="0" step="0.01" id="target" value="100.00">
    </label>
    <label>
        <input type="checkbox" id="useRolls"> Include Coin Rolls in Removal
    </label>
    <div id="removalList"></div>
    <button type="button" id="checkoutBackBtn">Back</button>
</div>

<!-- ==================== SUMMARY SCREEN ==================== -->
<div id="summaryScreen" class="screen" style="display:none;">
    <h1>Summary Dashboard</h1>
    <table>
        <thead>
            <tr>
                <th>Drawer</th>
                <th>Total Cash</th>
                <th>Target State</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody id="summaryTable"></tbody>
    </table>
    <button type="button" id="summaryBackBtn">Back</button>
</div>

<!-- ==================== ABOUT SCREEN ==================== -->
<div id="aboutScreen" class="screen" style="display:none;">
    <h1>About Cash Drawer Calculator</h1>
    <p>The Cash Drawer Calculator is a free, real-time tool that helps retail workers, small-business owners, and anyone managing cash registers count down drawers <strong>instantly</strong>.</p>
    <p><strong>How It Works (All Automatic):</strong></p>
    <ul>
        <li><strong>Input Screen:</strong> Enter banknote counts, loose coins, and coin-roll totals. The <strong>total cash</strong> updates <em>as you type</em> – no “Calculate” button needed.</li><br>
        <li><strong>Target State:</strong> Set a drawer target (default $100). The app instantly shows if you’re above, below, or at target.</li><br>
        <li><strong>Drawer Checkout:</strong> Tap “Drawer Checkout” to see exactly what to remove (or add) to hit the target. Toggle “Include Coin Rolls” to include/exclude rolls.</li><br>
        <li><strong>Summary Dashboard:</strong> View every drawer’s total, target, and status in a single table.</li><br>
        <li><strong>Multiple Drawers:</strong>
            <ul>
                <li><strong>Guest:</strong> Up to <strong>3 drawers</strong> (local storage only).</li>
                <li><strong>User / Supporter:</strong> Up to <strong>10 drawers</strong>, synced across devices.</li>
            </ul>
        </li><br>
        <li><strong>Auto-Save:</strong>
            <ul>
                <li>Guests: data is saved locally in your browser.</li>
                <li>Logged-in users: data is saved to the cloud (Firebase) <em>automatically</em> after every change.</li>
            </ul>
        </li>
    </ul>
    <p><strong>Extra Perks for Logged-In Accounts:</strong></p>
    <ul>
        <li>Dark mode (User & Supporter).</li>
        <li>Cloud backup – your drawers survive logouts, device changes, or browser clears.</li>
        <li>Supporter tier removes ads and unlocks the full 10-drawer limit.</li>
    </ul>
    <p><strong>Why It Was Created:</strong></p>
    <p>This tool eliminates the tedious, error-prone process of manual cash-counting. It’s fast, mobile-friendly, and works offline for guests. Whether you’re closing a shift, balancing a register, or preparing a deposit, the calculator does the math <strong>in real time</strong>.</p>
    <button type="button" id="aboutBackBtn">Back to Calculator</button>
</div>

<!-- ==================== LOGIN / SIGNUP SCREEN ==================== -->
<div id="loginScreen" class="screen" style="display:none;">
    <h1>Login or Signup</h1>
    <div id="loginSection">
        <h2>Login</h2>
        <form id="loginForm">
            <label>Username or Email: <input type="text" id="loginUsernameOrEmail" required></label>
            <label>Password: <input type="password" id="loginPassword" required></label>
            <button type="button" id="loginBtn">Login</button>
        </form>
    </div>
    <div id="registerSection">
        <h2>Register</h2>
        <form id="registerForm">
            <label>Username: <input type="text" id="registerUsername" required></label>
            <label>Email: <input type="email" id="registerEmail" required></label>
            <label>Password: <input type="password" id="registerPassword" required></label>
            <button type="button" id="signupBtn">Signup</button>
        </form>
    </div>
    <div id="loginError"></div>
    <button type="button" id="loginBackBtn">Back</button>
</div>

<!-- ==================== ACCOUNT SCREEN ==================== -->
<div id="accountScreen" class="screen" style="display:none;">
    <h1>Account</h1>
    <div id="accountStatus">
        <h2>Your Account Status</h2>
        <p id="statusMessage"></p>
        <div id="deleteAccountSection" style="display:none;">
            <button type="button" id="deleteAccountBtn" class="delete-account">Delete Account</button>
        </div>
    </div>
    <div id="accountTiers">
        <h2>Account Tiers</h2>
        <div class="tier-container">
            <div class="tier-card">
                <h3>Guest</h3>
                <ul>
                    <li>1 cash drawer</li>
                    <li>Local storage only</li>
                </ul>
            </div>
            <div class="tier-card">
                <h3>User Account</h3>
                <ul>
                    <li>3 cash drawers</li>
                    <li>Additional settings (e.g., dark mode)</li>
                    <li>Data storage across devices</li>
                </ul>
            </div>
            <div class="tier-card">
                <h3>Supporter Account</h3>
                <ul>
                    <li>Up to 10 cash drawers</li>
                    <li>Removes ads</li>
                    <li>All previous tier perks</li>
                </ul>
                <button id="upgradeToSupporterBtn" class="upgrade-button">Upgrade to Supporter</button>
            </div>
        </div>
    </div>
    <div id="settingsSection" style="display:none;">
        <h2>Settings</h2>
        <label><input type="checkbox" id="darkModeToggle"> Enable Dark Mode</label>
    </div>
    <br/>
    <button type="button" id="accountBackBtn">Back</button>
</div>

<!-- ==================== PRIVACY SCREEN ==================== -->
<div id="privacyScreen" class="screen" style="display:none;">
    <h1>Privacy Policy</h1>
    <p>Last updated: September 16, 2025</p>
    <p>This Privacy Policy explains how the Cash Drawer Calculator ("we," "us," or "our") collects, uses, discloses, and protects your personal information when you use our website and services.</p>
    <h2>1. Information We Collect</h2>
    <p>We collect the following types of information:</p>
    <ul>
        <li><strong>Personal Information:</strong> When you register or log in, we collect your username, email address, and password.</li>
        <li><strong>Usage Data:</strong> We collect data related to your cash drawer inputs, such as counts of banknotes, coins, and rolls, stored in our database to provide the service.</li>
        <li><strong>Technical Data:</strong> We may collect technical information such as IP addresses and device information through our use of Firebase services.</li>
    </ul>
    <h2>2. How We Use Your Information</h2>
    <p>We use your information to:</p>
    <ul>
        <li>Provide and maintain the Cash Drawer Calculator service, including saving your drawer data across sessions.</li>
        <li>Authenticate your account and manage user sessions.</li>
        <li>Improve our services through aggregated, anonymized analytics.</li>
    </ul>
    <h2>3. How We Share Your Information</h2>
    <p>We do not sell your personal information. We share your information only with:</p>
    <ul>
        <li><strong>Service Providers:</strong> We use Google Firebase for authentication and data storage. Firebase processes your data in accordance with their <a href="https://firebase.google.com/terms" target="_blank">Terms of Service</a> and <a href="https://policies.google.com/privacy" target="_blank">Privacy Policy</a>.</li>
        <li><strong>Legal Obligations:</strong> We may disclose your information if required by law or to protect our rights.</li>
    </ul>
    <h2>4. Data Storage and Security</h2>
    <p>Your data is stored securely in Firebase's encrypted databases. We retain your personal information and drawer data as long as your account is active or as needed to provide the service. If you delete your account, we will remove your data from our systems, subject to Firebase's retention policies.</p>
    <h2>5. Your Rights</h2>
    <p>You have the following rights regarding your personal information:</p>
    <ul>
        <li><strong>Access:</strong> You can view your account details on the Account page.</li>
        <li><strong>Deletion:</strong> You can delete your account and associated data via the "Delete Account" button on the Account page.</li>
        <li><strong>Opt-Out:</strong> You can stop using the service at any time, and guest users can clear local storage via browser settings.</li>
    </ul>
    <p>If you are in the EU, you have additional rights under GDPR, including data portability and objection to processing. Contact us to exercise these rights.</p>
    <h2>6. Cookies and Tracking</h2>
    <p>We do not use cookies or similar tracking technologies for analytics or advertising. Firebase may use session-based identifiers for authentication purposes.</p>
    <h2>7. Third-Party Links</h2>
    <p>Our website may contain links to third-party sites (e.g., Firebase Terms). We are not responsible for their privacy practices.</p>
    <h2>8. Changes to This Privacy Policy</h2>
    <p>We may update this Privacy Policy from time to time. Changes will be posted on this page with an updated "Last updated" date.</p>
    <h2>9. Contact Us</h2>
    <p>For questions or to exercise your data rights, contact me at: <a href="mailto:bjung031@gmail.com">bjung031@gmail.com</a></p>
    <button type="button" id="privacyBackBtn">Back to Calculator</button>
</div>

<!-- Save Status Toast -->
<div id="saveStatus" style="
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #0a0;
    color: white;
    padding: 10px 16px;
    border-radius: 6px;
    font-size: 14px;
    opacity: 0;
    transition: opacity 0.3s;
    z-index: 1000;
    pointer-events: none;
">
    Saved to cloud
</div>

<!-- ==================== SCRIPTS ==================== -->
<script src="js/auth.js?v=3"></script>
<script src="js/utils.js"></script>
<script src="js/main.js?v=3"></script>
</body>
</html>